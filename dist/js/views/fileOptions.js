define(["backbone","underscore","jquery","vent","bootstrap"],function(e,t,n,r){return e.View.extend({el:"#file-settings",publicBase:"http://www.markdowner.com/document/",initialize:function(){r.on("editor:loadDocument",this.setModel,this),r.on("fileOptions:show",this.show,this),r.on("fileOptions:hide",this.hide,this),r.on("fileOptions:toggle",this.toggle,this),this.$el.tooltip({selector:'a[data-toggle="tooltip"]'})},events:{"click .public-button":"togglePublic","click .remark-button":"toggleRemark",'focus input[type="text"]':"selectText"},setModel:function(e){this.model=e,this.render()},selectText:function(){var e=this;setTimeout(function(){e.$el.find('input[type="text"]').select()},300)},togglePublic:function(){if(!this.model)return;var e=this.model.get("public")||!1;if(this.model.get("remark"))return;this.model.save({"public":!e}).then(n.proxy(this.render,this))},toggleRemark:function(){if(!this.model)return;var e=this.model.get("remark")||!1;this.model.get("public")||this.model.set("public",!0),this.model.save({remark:!e}).then(n.proxy(this.render,this))},show:function(e){this.setModel(e),this.$el.show()},hide:function(){this.$el.hide()},toggle:function(e){this.setModel(e),this.$el.toggle()},render:function(){if(!this.model)return;var e=this.$el.find('input[type="text"]'),t=this.$el.find(".public-button"),n=this.$el.find(".remark-button"),i=this.model.get("public"),s=this.model.get("remark");return e.val(this.publicBase+this.model.get("_id")),i?(t.addClass("btn-info active"),e.addClass("readonly").removeAttr("disabled")):(t.removeClass("btn-info active"),e.removeClass("readonly").attr("disabled","disabled")),s?n.addClass("btn-info active"):n.removeClass("btn-info active"),r.trigger("editor:compile"),this}})});